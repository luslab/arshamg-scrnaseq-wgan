#!/usr/bin/env nextflow
/*
========================================================================================
                         luslab/scrnaseq-gann
========================================================================================
----------------------------------------------------------------------------------------
*/

// Define DSL2
nextflow.preview.dsl=2

/* Module inclusions 
--------------------------------------------------------------------------------------*/

/*------------------------------------------------------------------------------------*/
/* Params
--------------------------------------------------------------------------------------*/

/*------------------------------------------------------------------------------------*/
/* Processes
--------------------------------------------------------------------------------------*/

process runGann {
  publishDir "${params.outdir}/gann",
    mode: "copy", overwrite: true

    input:
      path(data_dir)

    output:
      path("*.*")

    shell:
      """
      python $baseDir/bin/arsh_attempt_2/main_train.py --train --epochs ${params.epochs} --write_freq ${params.writefreq} --output_dir . --data_dir ${data_dir}
      """
}

/*------------------------------------------------------------------------------------*/

// Run workflow
workflow {

  Channel
    .from(params.data_dir)
    .set {ch_data}

    // run gann
    runGann(ch_data)
}